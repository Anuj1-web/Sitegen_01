<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Wizard Maker</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="card">
    <h1>Wizard Maker â€” Full Editor</h1>
    <input type="file" id="zipInput" accept=".zip">
    <button id="exportBtn">Export ZIP</button>
    <div id="tabs"></div>
    <div id="iframeContainer"></div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const storedTemplate = localStorage.getItem("wizardTemplate");
  if (storedTemplate) {
    fetch(storedTemplate)
      .then(res => res.blob())
      .then(blob => {
        const file = new File([blob], "template.zip", { type: "application/zip" });

        const dt = new DataTransfer();
        dt.items.add(file);
        document.getElementById("zipInput").files = dt.files;

        const event = new Event("change");
        document.getElementById("zipInput").dispatchEvent(event);

        localStorage.removeItem("wizardTemplate");
      });
  }

  // Listen to ZIP upload manually too
  document.getElementById("zipInput").addEventListener("change", async (e) => {
    const file = e.target.files[0];
    if (!file) return;
    const jszip = new JSZip();
    const zip = await jszip.loadAsync(file);
    for (const filename in zip.files) {
      if (!zip.files[filename].dir) {
        const content = await zip.files[filename].async("string");
        const iframe = document.createElement("iframe");
        iframe.style.width = "100%";
        iframe.style.height = "500px";
        iframe.srcdoc = content;
        document.getElementById("iframeContainer").appendChild(iframe);
      }
    }
  });
});
</script>
</body>
</html>
